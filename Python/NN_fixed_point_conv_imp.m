clear all;
close all;

test = csvread('test_result.csv');
input  = test(2:401,1:17);
output = test(2:401,18); %431
out_L1_max = 0;
out_L2_max = 0;
out_L_max  = 0;
weight_L1 = [ ...
-2.33534932e-01  -2.14525834e-01  -1.50247681e+00 ...
 3.01817513e+00  -1.86446011e+00   5.80542707e+00 ...
 3.01483989e+00  -3.49992245e-01  -1.47362605e-01 ...
-3.84659219e+00  -1.29605901e+00   3.39065969e-01 ...
 1.02726132e-01  -1.41476619e+00  -8.90751183e-02 ...
-2.29067564e+00   2.49144197e+00  -3.09794188e-01 ...
-2.87304252e-01  -5.77240407e-01  -3.43082595e+00 ...
 1.51463836e-01  -2.84643402e+01  -1.17540188e+01 ...
 8.19705200e+00  -4.59894896e+00   8.79566574e+00 ...
-2.49171662e+00  -1.32431209e-01  -1.18792558e+00;...
-1.38852045e-01  -3.25122356e-01   4.59954655e-03 ...
 6.46181059e+00   1.94201970e+00  -2.90873313e+00 ...
-8.59841883e-01   1.50234893e-01  -1.01775557e-01 ...
 2.91298795e+00   1.78089440e-02  -1.23062700e-01 ...
-1.39569640e-01   2.43829802e-01  -3.56486440e-03 ...
-5.64809370e+00  -9.65541840e-01   1.41549644e+01 ...
-1.00220209e-02   1.43495226e+00   1.49994707e+00 ...
 6.13652989e-02   3.68485031e+01  -2.76584363e+00 ...
 2.43063469e+01   4.63213873e+00  -9.35746670e+00 ...
 2.68103659e-01  -1.44594908e-01  -3.30532289e+00;...
-2.78690964e-01  -2.84706503e-01   6.36373460e-02 ...
-1.20164347e+00  -1.51134574e+00  -2.24310279e+00 ...
-3.61745596e-01  -1.62213191e-01  -8.55876207e-02 ...
-1.74857771e+00   9.73097831e-02  -3.54368925e-01 ...
-3.25996041e-01   8.80779140e-03  -2.17686474e-01 ...
-1.29690194e+00  -3.25718820e-01  -6.09001517e-01 ...
 1.51401594e-01  -1.53123736e+00  -6.11112773e-01 ...
-3.10017377e-01   7.50268042e-01  -1.62376022e+00 ...
 3.43205720e-01  -4.88931149e-01  -1.83842444e+00 ...
 1.05678111e-01   1.33864030e-01  -1.71442437e+00;...
-1.30705133e-01  -1.87168017e-01   7.61257172e-01 ...
 1.70644455e+01   3.43889028e-01  -5.42666817e+00 ...
-5.10974884e-01   3.36823076e-01   1.60950422e-03 ...
 2.49614298e-01   3.48730296e-01   3.31927836e-01 ...
 1.06029719e-01   2.98998594e-01   2.93225348e-01 ...
 4.63908529e+00  -3.18818122e-01   3.31031647e+01 ...
-1.38681978e-01   1.25558451e-01   2.31360316e+00 ...
-7.07564317e-03  -1.75691414e+00   4.52012032e-01 ...
-4.81587458e+00   1.77971435e+00  -4.67426586e+00 ...
 4.02061075e-01   2.45791346e-01  -1.84152818e+00;...
 1.58066332e-01   1.74488127e-01   7.27795839e-01 ...
 1.88339138e+01   4.26063269e-01  -2.67153096e+00 ...
-5.91236591e-01  -2.12882850e-02   2.95286894e-01 ...
 6.90986991e-01  -2.15100601e-01   1.71839178e-01 ...
 1.18352264e-01   6.61198497e-01  -1.11367896e-01 ...
 8.74520302e+00   7.12244585e-02   1.50657644e+01 ...
 3.81055981e-01  -4.14287806e-01   3.57470322e+00 ...
 2.67528951e-01   5.96626616e+00   1.14820480e+00 ...
-2.10117092e+01   2.85406351e+00  -3.73356366e+00 ...
 3.16505283e-01  -1.87015131e-01  -1.01409125e+00;...
 1.17194325e-01  -2.67096937e-01   4.29145038e-01 ...
 7.60347652e+00   4.25529890e-02  -7.31800795e+00 ...
-8.65176320e-01  -1.13042600e-01  -2.41959393e-01 ...
 3.27860594e-01  -3.72176543e-02  -2.42375523e-01 ...
 1.43040597e-01   2.18793571e-01  -1.89702287e-01 ...
 2.45467687e+00   3.43576558e-02   1.68451710e+01 ...
 3.84962589e-01  -3.56457323e-01   2.07343936e+00 ...
 2.40603432e-01   6.10495520e+00  -1.37979895e-01 ...
-4.17585278e+00   1.72439802e+00  -4.32358408e+00 ...
 5.33324480e-02  -1.86808318e-01  -2.32765460e+00;...
 1.78736925e-01  -2.89859831e-01   2.52789825e-01 ...
 2.16100540e+01  -1.36705741e-01  -3.89124680e+00 ...
-5.47074676e-01  -5.89047782e-02  -4.90996838e-02 ...
 3.23296994e-01   3.19818825e-01  -1.16550162e-01 ...
-9.48877037e-02   2.26949483e-01   2.43151724e-01 ...
 7.53374767e+00   4.53854129e-02   3.02110615e+01 ...
 9.30006206e-02  -1.88146502e-01   2.58433390e+00 ...
 7.01140091e-02  -1.26170454e+01   2.62293905e-01 ...
-1.24866982e+01   1.70431507e+00  -7.60725021e+00 ...
-3.07073388e-02   1.85265671e-02  -9.41467822e-01;...
 3.26199472e-01   3.40219736e-01   7.02714860e-01 ...
 1.40999441e+01   1.71759143e-01  -5.66908455e+00 ...
-7.28901446e-01   2.12219536e-01   5.25016487e-02 ...
 6.41455531e-01  -2.44303092e-01  -1.44071117e-01 ...
 2.95501590e-01   7.30770350e-01   1.84036314e-01 ...
 6.36654997e+00  -1.63796514e-01   1.65483246e+01 ...
 3.56987715e-01  -1.93741530e-01   3.34013510e+00 ...
 2.09049791e-01   1.86538815e+00   4.18445915e-01 ...
-1.90079250e+01   2.43155956e+00  -2.95047188e+00 ...
 4.30198312e-01  -2.59701014e-01  -2.18478370e+00;...
-1.41968563e-01   2.87782252e-01   3.98227245e-01 ...
 3.08769226e+01  -1.77261412e-01  -1.47961962e+00 ...
-6.97853088e-01  -6.48238882e-02   2.32649922e-01 ...
 7.63853073e-01   3.10886562e-01   7.89140165e-02 ...
-6.43330812e-03   7.09941328e-01  -3.22295070e-01 ...
 6.98056221e+00  -1.50092348e-01   5.49209938e+01 ...
 2.66774833e-01  -7.84069672e-03   2.27478528e+00 ...
 2.68988639e-01   1.96623859e+01   7.30538726e-01 ...
-8.97179794e+00   1.69065356e+00  -1.99107969e+00 ...
 3.42098504e-01  -2.13521764e-01  -8.07800710e-01;...
 9.42698121e-03  -2.70971954e-01   1.08248127e+00 ...
 2.61192360e+01  -8.82533658e-03  -2.27099252e+00 ...
-3.36759299e-01   1.24152929e-01  -3.26290339e-01 ...
 7.16615796e-01   2.83316057e-02  -3.56916755e-01 ...
-2.00508013e-01   4.75757867e-01   2.21306503e-01 ...
 9.43150997e+00  -5.82901686e-02   3.57385483e+01 ...
 3.30424935e-01   1.43149868e-01   3.70669031e+00 ...
 2.97283351e-01   7.55404949e+00   1.51787150e+00 ...
-1.24748678e+01   2.16871810e+00  -2.80474544e+00 ...
 5.92090964e-01  -2.14175925e-01  -7.85751164e-01;...
 2.05831885e-01  -8.13380480e-02   4.77394223e-01 ...
 1.73380013e+01   3.48829143e-02  -5.49058342e+00 ...
-6.76217616e-01  -2.07689956e-01  -1.71210349e-01 ...
 7.05775082e-01  -3.05327952e-01   9.43057835e-02 ...
-1.91310003e-01   6.26100361e-01  -1.10537246e-01 ...
 5.06252909e+00  -2.78921276e-01   3.28537979e+01 ...
-7.71806538e-02  -3.64505470e-01   2.62514853e+00 ...
 2.67264307e-01  -1.73990488e+00   1.33656159e-01 ...
-4.66319704e+00   1.83660054e+00  -4.54742718e+00 ...
 3.99635047e-01   2.71412224e-01  -1.65623188e+00;...
 2.58525431e-01  -2.22400993e-01   8.72786641e-01 ...
 1.86258259e+01   2.64981896e-01  -2.60959220e+00 ...
-8.20457339e-01  -1.22356772e-01   2.66591072e-01 ...
 8.60394895e-01   1.48806974e-01   4.30812240e-02 ...
-6.02780879e-02   7.37259507e-01   9.33184922e-02 ...
 9.33270073e+00  -3.62151891e-01   1.45889235e+01 ...
 2.02292889e-01  -2.22157925e-01   3.68863535e+00 ...
-1.62066340e-01   6.45697260e+00   1.25248051e+00 ...
-2.13737545e+01   2.64442205e+00  -3.84990382e+00 ...
 3.68803233e-01  -1.19750865e-01  -1.26140249e+00;...
 8.15153122e-04   3.21385086e-01   4.30071652e-01 ...
 1.98382721e+01   1.05172873e-01   1.96754682e+00 ...
-6.49244785e-01  -1.28575087e-01  -6.62554801e-02 ...
 6.97814047e-01  -1.14909969e-01  -2.68826097e-01 ...
-1.65263101e-01   1.66745320e-01  -8.16804171e-02 ...
 4.18498850e+00   1.91839412e-01   3.41994781e+01 ...
 2.88651794e-01  -7.88705498e-02   2.25305152e+00 ...
 2.86724985e-01  -2.56694245e+00   3.26600730e-01 ...
 2.79126000e+00   1.83298194e+00   3.50156665e+00 ...
 5.27985573e-01  -3.22378159e-01  -6.68021977e-01;...
-2.87419856e-01   2.26462543e-01   8.39098752e-01 ...
 1.83849373e+01  -1.28076479e-01  -8.23544216e+00 ...
-1.26867747e+00   8.37783739e-02   6.10571206e-02 ...
 1.05128694e+00   3.47348928e-01   4.63534594e-02 ...
-4.50328290e-02   7.74269462e-01   9.07051563e-02 ...
 4.17615318e+00  -2.15318799e-01   3.88065071e+01 ...
 1.91737860e-01  -2.33714245e-02   3.27184606e+00 ...
-3.29914153e-01   8.18810821e-01  -6.40292108e-01 ...
-1.68933964e+00   2.45781398e+00  -3.40692782e+00 ...
 7.30458379e-01   1.39769226e-01  -3.69435167e+00;...
-1.80945113e-01  -1.75348490e-01   7.77737737e-01 ...
 7.85854053e+00   1.82619714e-03  -7.17545462e+00 ...
-3.77917975e-01  -3.03369045e-01  -3.11839610e-01 ...
 7.00909495e-01   3.19281280e-01  -3.45661312e-01 ...
-1.95805758e-01   1.90120086e-01   1.74089134e-01 ...
 2.40049911e+00  -5.31863153e-01   1.63588619e+01 ...
-1.78921223e-01  -2.95493215e-01   2.03559828e+00 ...
 2.76752770e-01   6.59113359e+00   2.49304309e-01 ...
-3.86855102e+00   1.59799623e+00  -4.21686363e+00 ...
 1.10828489e-01   1.67959198e-01  -2.51615334e+00;...
 2.47321486e-01  -1.74293220e-01   9.23383176e-01 ...
 1.35579519e+01   4.65252370e-01  -5.29365444e+00 ...
-9.96015728e-01   2.28945851e-01   3.50020468e-01 ...
 3.78667921e-01  -9.10389125e-02   3.23904634e-01 ...
-3.56708109e-01   2.20328331e-01  -6.01032078e-02 ...
 6.17742205e+00  -5.70453890e-02   1.65872574e+01 ...
 1.10299699e-01   2.68648267e-02   3.43654823e+00 ...
-1.61862180e-01   1.80625486e+00  -6.22639917e-02 ...
-1.91807041e+01   2.88942361e+00  -3.01795578e+00 ...
 5.91294289e-01  -1.89449966e-01  -2.27159333e+00;...
 9.24466848e-02   2.91269422e-01   1.17004490e+00 ...
 2.62594452e+01   5.58732271e-01  -1.90653503e+00 ...
-6.82449639e-01   1.37056455e-01  -3.00058097e-01 ...
 1.26854289e+00   1.31110042e-01  -3.40330482e-01 ...
 2.31328189e-01   6.05292797e-01  -1.65041879e-01 ...
 9.39607716e+00   2.25149304e-01   3.58057976e+01 ...
 4.84814256e-01   1.00918248e-01   3.62586617e+00 ...
-1.71835825e-01   7.32594681e+00   1.47433126e+00 ...
-1.24070692e+01   2.63442755e+00  -2.51391959e+00 ...
 3.20997149e-01   2.60059446e-01  -1.00830817e+00];

bias_L1 = [ ... 
 0.          0.         -0.0799267   0.98428464  1.1174476  ...
 2.1102638   0.05321032 -0.14989811  0.          1.2169796  ...
-0.10456642  0.          0.         -0.252235    0.         ...
 1.2717968   0.07757258  0.48040125 -0.15511927  1.1412035  ...
 0.36569148 -0.06977715 -0.62761945  1.4881657  -0.1335276  ...
 0.51653564  1.6699402  -0.2837765  -0.13224764  1.707161];
 
weights_L2 = [ ...
-3.56342494e-02   4.74861264e-03   3.70205343e-02 ... 
-3.10782552e-01   1.38163179e-01   3.15145522e-01 ... 
 3.71998042e-01   2.46659189e-01  -2.78272629e-01;... 
-2.76328921e-02   1.82962984e-01   6.79551661e-02 ... 
 1.61431342e-01  -3.46216679e-01  -1.96210206e-01 ... 
-2.24862412e-01  -2.47713760e-01   1.78436786e-01;... 
 5.26240230e-01  -1.52887225e-01  -8.06220412e-01 ... 
-2.80143827e-01  -3.29480767e-01   1.21924773e-01 ... 
-1.49117410e-01   3.25958252e-01  -2.10652482e-02;... 
-2.18174744e+00  -2.20270529e-01  -6.53438568e-01 ... 
-1.71960577e-01   3.44328785e+00   1.66395020e+00 ... 
-5.98855066e+00  -2.01816988e+00   2.57709599e+00;... 
-1.76000237e-01   2.94957489e-01   2.47006035e+00 ... 
-3.15375999e-02   2.38834113e-01  -8.41739058e-01 ... 
 5.19646287e-01  -1.36352265e+00   3.65478963e-01;... 
 7.24577129e-01   2.14336663e-01  -2.34388590e+00 ... 
 2.74731487e-01   5.10438681e+00   4.62161511e-01 ... 
 1.78019977e+00  -1.36480582e+00   2.39784718e+00;... 
 9.68221724e-01  -1.05169557e-01   8.51909369e-02 ... 
-4.53411266e-02   2.68939114e+00  -3.95255148e-01 ... 
-2.78764462e+00  -3.23199123e-01   1.85242438e+00;... 
-3.09362799e-01  -1.78926930e-01  -2.20122144e-01 ... 
 6.95803910e-02   2.94811666e-01   9.57050696e-02 ... 
 3.07374030e-01   3.02180946e-01  -1.87761292e-01;... 
-1.22880340e-02  -2.95083553e-01   1.90218419e-01 ... 
 1.85782403e-01   2.99775392e-01   6.28787279e-03 ... 
 3.78196239e-02   1.70380205e-01   1.29484385e-01;... 
-5.39004028e-01   1.88431099e-01   2.71008611e+00 ... 
 2.72137165e-01   1.08851445e+00  -9.92059827e-01 ... 
 1.22008252e+00  -1.60955310e+00   7.27173686e-01;... 
 6.06792033e-01  -2.68850297e-01  -1.13405183e-01 ... 
-3.44245851e-01  -4.07265753e-01   8.24419484e-02 ... 
-8.62883925e-02  -5.31007648e-02   2.84926951e-01;... 
-2.88134784e-01   2.88311452e-01   3.80371243e-01 ... 
-7.18212724e-02   2.11880296e-01   1.11162394e-01 ... 
-1.83274597e-01  -3.23051393e-01   1.12623781e-01;... 
 1.80012971e-01  -2.94705003e-01   3.20911199e-01 ... 
 1.53240860e-02  -3.15325856e-02  -2.05560729e-01 ... 
-1.88640878e-01   1.50822133e-01   1.33850425e-01;... 
 4.57813799e-01  -3.83873969e-01  -2.97208428e-01 ... 
 1.64371580e-01  -2.75347292e-01   2.53639132e-01 ... 
 1.75418913e-01   1.74213260e-01   1.28296807e-01;... 
-2.72682667e-01   5.16317487e-02   3.54566962e-01 ... 
 7.79697299e-02   6.70412183e-03  -3.45275819e-01 ... 
-3.37511301e-04   3.51872474e-01   1.26969010e-01;... 
-9.09555435e-01   2.74567038e-01   3.76880825e-01 ... 
-3.32862347e-01   2.42447710e+00   5.20134747e-01 ... 
-2.21077228e+00  -7.93800950e-01   5.94069660e-01;... 
 9.19253588e-01  -8.33278336e-03   4.38304096e-02 ... 
-2.64595002e-01   2.87936831e+00  -2.45533243e-01 ... 
-2.19925070e+00  -8.72929156e-01   1.97852409e+00;... 
-3.02220297e+00   3.02446276e-01   4.74782419e+00 ... 
-3.00141335e-01   2.67115736e+00   7.35977125e+00 ... 
 1.45891398e-01   5.90257788e+00   7.70268011e+00;... 
 1.07742131e-01   2.81610519e-01  -1.03063345e+00 ... 
-2.81452537e-01  -6.29673183e-01   4.85446572e-01 ... 
-9.82862338e-02   4.69987780e-01  -1.30352631e-01;... 
-1.83587030e-01  -2.70685136e-01   2.28298736e+00 ... 
-2.51708001e-01   1.34477913e-01  -5.68347991e-01 ... 
 6.40477240e-01  -1.36019731e+00   3.97856325e-01;... 
 1.24397790e+00  -3.65652919e-01   1.39279056e+00 ... 
 2.29853258e-01   4.84583318e-01  -1.70363262e-01 ... 
 9.94079411e-01   2.51515396e-02   5.67760110e-01;... 
 5.87012619e-02   1.27601717e-02  -1.92089468e-01 ... 
-3.31500739e-01  -1.23619311e-01   1.30435824e-03 ... 
 3.63540977e-01  -1.27039179e-02   2.03754976e-02;... 
-1.12960488e-01  -2.33045831e-01   6.41361046e+00 ... 
-4.11978848e-02  -7.75902653e+00   1.16453114e+01 ... 
 8.14202499e+00   7.78779268e+00   1.20895071e+01;... 
-3.18833232e-01  -2.57199228e-01   2.18107557e+00 ... 
-5.91722690e-02   5.24826813e+00  -1.39148772e+00 ... 
 5.43080531e-02  -3.70145345e+00  -1.54596710e+00;... 
 3.81102324e-01  -6.37216866e-02  -2.05287695e+00 ... 
-3.99568342e-02  -2.69187355e+00  -2.91374063e+00 ... 
 4.51305628e+00   5.83529758e+00  -2.51790810e+00;... 
 5.70344985e-01  -2.85626173e-01   9.49427247e-01 ... 
 2.98845470e-01   6.29727602e-01   1.87724113e-01 ... 
-2.87283492e+00  -1.15569985e+00   9.75541770e-02;... 
 1.66804516e+00  -1.34558734e-02  -4.67605877e+00 ... 
-3.90556872e-01   5.47592592e+00   3.72317648e+00 ... 
 1.67268145e+00  -2.75799227e+00   1.93481445e+00;... 
 1.98121279e-01   2.27689222e-02   6.45836294e-02 ... 
-1.17052473e-01  -4.69589233e-01   2.11270541e-01 ... 
 9.92915705e-02   6.41168654e-01   3.40746939e-02;... 
-2.45526865e-01   3.34598780e-01   1.01717740e-01 ... 
-9.48775113e-02  -2.21134752e-01  -5.27611189e-02 ... 
-2.15235457e-01  -3.07391077e-01  -2.12454289e-01;... 
 5.80497503e-01  -3.38791877e-01  -6.41375855e-02 ... 
 4.91615850e-04   2.81196046e+00   8.89099121e-01 ... 
-1.50941288e+00  -5.56036770e-01  -2.12632149e-0];



bias_L2 = [-0.5447524 -0.13058789 0.02902053 -0.08459416 -2.3639352 -0.11617318 -2.2247715 -0.13984442 -0.24369135];


weights_out_L = [
 1.7469397   -6.2329087   -0.11721293;     ...
-0.2830153   -0.42569172  -0.08468739;     ...
 2.3484147    4.299548    -6.727368;       ...
 0.1732485   -0.23126893  -0.53091335;     ...
 1.022514    -0.8165869   -3.6917057;      ...
 1.9267062   -1.3951429   -1.6861377;      ...
-12.12723     1.1340408    12.10454;       ...
 2.5041063   -2.6056705   -2.5222902;      ...
 1.7016369   -0.23261385  -2.5787778];

bias_out_L = [-3.8591182 -9.170574  4.0372176];
 
%input_L1 = input'.*weight_L1(:,23);
input_L1 = input*weight_L1;
n = size(input_L1);
out_L1 = zeros(n);

%w8_L1 = weight_L1;
%w8_L1_fix = bin(fi(w8_L1,1,25,19));
%bias_L1_fix = bin(fi(bias_L1,1,48,38));

%w8_L2 = weights_L2;
%w8_L2_fix = bin(fi(w8_L2,1,25,19));
%bias_L2_fix = bin(fi(bias_L2,1,48,38));

%w8_out_L     = weights_out_L;
%w8_out_L_fix = bin(fi(w8_out_L,1,25,19));
%bias_out_L_fix  = bin(fi(bias_out_L,1,48,38));



for i=1:n(1,1)
    out_L1(i,:) = input_L1(i,:) + bias_L1;
    for j=1:n(1,2)
        if(out_L1(i,j) < 0)
            out_L1(i,j) = 0;
        end
    end
end


in_L2 = out_L1*weights_L2;
n1 = size(in_L2);
out_L2 = zeros(n1);

for i=1:n1(1,1)
    out_L2(i,:) = in_L2(i,:) + bias_L2;
    for j=1:n1(1,2)
        if(out_L2(i,j) < 0)
            out_L2(i,j) = 0;
        end
    end
end

in_out_L = out_L2*weights_out_L;
n2 = size(in_out_L);
out_L = zeros(n2);

for i=1:n2(1,1)
    out_L(i,:) = in_out_L(i,:) + bias_out_L;
end



Value = zeros(n2(1,1),1);
I = zeros(n2(1,1),1);

for i=1:n1(1,1)
[Value(i),I(i)] = max(out_L(i,:));
end

EB_count = 0;
HD_count = 0;
LB_count = 0;

for i=1:n1(1,1)
	if(i >=1   && i <= 150)
        if( I(i) == 1)
            EB_count = EB_count + 1;
        end
    end
	if(i >=151 && i <= 350)
        if( I(i) == 2)
            HD_count = HD_count + 1;
        end
    end
	if(i >=351 && i <= 430)
        if( I(i) == 3)
            LB_count = LB_count + 1;
        end
    end
end

Total_accuray = (EB_count/150 + HD_count/200 + LB_count/80) / 3



%%%%%%%%%%fixed point multiplication%%%%%%%%%%%%%%
%weight_L1_bin  = hex(fi(weight_L1,1,31,20));     % 11+20 = 31
%weight_L2_bin  = hex(fi(weights_L2,1,31,20));    %
%weight_out_bin = hex(fi(weights_out_L,1,31,20)); %

%bias_L1_bin    = hex(fi(bias_L1,1,61,40));       % 21+40 = 61
%bias_L2_bin    = hex(fi(bias_L2,1,61,40));
%bias_out_bin   = hex(fi(bias_out_L,1,61,40));


%input_data = string('');
%for i=1:430
%    for j=1:17
%        input_data(i,j) = append("32'h",(num2hex(single(input(i,j)))));
%    end
%end

%%% case1 31,20 & 61,60  %11-20
%%% case1 25,15 & 49,30  %10-15
%%% case1 26,15 & 50,30  %11-15
%%% case4 29,18 & 57,36  %11-18
%%% case5 30,19 & 59,38  %11-19 

weight_L1_bin = string('');
for i=1:17
    for j=1:30
        %weight_L1_bin(i,j) = append("w8_L1_N",int2str(j),"_",int2str(i-1),"= 31'h",hex(fi(weight_L1(i,j),1,31,20)),",");
        weight_L1_bin(i,j) = append("w8_L1_N",int2str(j),"_",int2str(i-1),"= 30'h",hex(fi(weight_L1(i,j),1,30,19)),",");
    end
end

weight_L2_bin = string('');
for i=1:30
    for j=1:9
        %weight_L2_bin(i,j) = append("w8_L2_N",int2str(j),"_",int2str(i-1),"= 31'h",hex(fi(weights_L2(i,j),1,31,20)),",");
        weight_L2_bin(i,j) = append("w8_L2_N",int2str(j),"_",int2str(i-1),"= 30'h",hex(fi(weights_L2(i,j),1,30,19)),",");
    end
end

weight_out_bin = string('');
for i=1:9
    for j=1:3
        %weight_out_bin(i,j) = append("w8_out_L_N",int2str(j),"_",int2str(i-1),"= 31'h",hex(fi(weights_out_L(i,j),1,31,20)),",");
        weight_out_bin(i,j) = append("w8_out_L_N",int2str(j),"_",int2str(i-1),"= 30'h",hex(fi(weights_out_L(i,j),1,30,19)),",");
    end
end

bias_L1_bin = string('');
for j=1:30
    %bias_L1_bin(j) = append("b_L1_N",int2str(j)," = 59'h",hex(fi(bias_L1(j),1,61,40)),",");
    bias_L1_bin(j) = append("b_L1_N",int2str(j)," = 59'h",hex(fi(bias_L1(j),1,59,38)),",");
end

bias_L2_bin = string('');
for j=1:9
    %bias_L2_bin(j) = append("b_L2_N",int2str(j)," = 61'h",hex(fi(bias_L2(j),1,61,40)),",");
    bias_L2_bin(j) = append("b_L2_N",int2str(j)," = 59'h",hex(fi(bias_L2(j),1,59,38)),",");
end

bias_out_bin = string('');
for j=1:3
    %bias_out_bin(j) = append("b_out_L_N",int2str(j)," = 61'h",hex(fi(bias_out_L(j),1,61,40)),",");
    bias_out_bin(j) = append("b_out_L_N",int2str(j)," = 59'h",hex(fi(bias_out_L(j),1,59,38)),",");
end

fid = fopen('NN_fixed_we_bias.txt', 'wt');
formatSpec = '%s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s\n'
fprintf(fid, formatSpec, weight_L1_bin);
fprintf(fid,  '\n');
formatSpec = '%s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s\n'
fprintf(fid, formatSpec, weight_L2_bin);
fprintf(fid,  '\n');
formatSpec = '%s  %s  %s  %s  %s  %s  %s  %s  %s\n'
fprintf(fid, formatSpec, weight_out_bin);
fprintf(fid,  '\n');
formatSpec = '%s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s\n'
fprintf(fid, formatSpec, bias_L1_bin);
fprintf(fid,  '\n');
formatSpec = '%s  %s  %s  %s  %s  %s  %s  %s  %s\n'
fprintf(fid, formatSpec, bias_L2_bin);
fprintf(fid, '\n');
formatSpec = '%s  %s  %s\n'
fprintf(fid, formatSpec, bias_out_bin);
fprintf(fid, '\n');
fclose(fid);



if(out_L1_max < max(max(out_L1)))
    out_L1_max = max(max(out_L1));
end
if(out_L2_max < max(max(out_L2)))
    out_L2_max = max(max(out_L2));
end
if(out_L_max  < max(max(out_L)))
   out_L_max  = max(max(out_L));
end


